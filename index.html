<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ISU Excellence Award Voting System</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
            color: #333;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            color: white;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        h1 {
            font-size: 2.8rem;
            margin-bottom: 10px;
            letter-spacing: 1px;
        }

        h2 {
            font-size: 1.5rem;
            font-weight: 400;
            margin-bottom: 20px;
        }

        .card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            padding: 30px;
            margin-bottom: 25px;
            transition: transform 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
        }

        .instructions {
            text-align: center;
            font-size: 1.1rem;
            margin-bottom: 20px;
            color: #444;
        }

        .warning {
            color: #e74c3c;
            font-weight: bold;
            margin-top: 10px;
        }

        .progress-container {
            margin: 25px 0;
        }

        .progress-bar {
            height: 12px;
            background-color: #ecf0f1;
            border-radius: 6px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #2ecc71, #27ae60);
            border-radius: 6px;
            transition: width 0.5s ease;
        }

        .progress-text {
            text-align: center;
            margin-top: 10px;
            font-weight: 600;
            color: #2c3e50;
        }

        .category-title {
            font-size: 1.6rem;
            color: #2c3e50;
            margin-bottom: 15px;
            text-align: center;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }

        .candidates-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }

        .candidate-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            transition: all 0.3s ease;
            border: 3px solid transparent;
        }

        .candidate-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.15);
        }

        .candidate-card.selected {
            border-color: #27ae60;
            background-color: #e8f6f3;
        }

        .candidate-photo {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            object-fit: cover;
            margin: 0 auto 15px;
            border: 4px solid #3498db;
            background-color: #ecf0f1;
        }

        .candidate-name {
            font-weight: 700;
            font-size: 1.1rem;
            margin-bottom: 5px;
            color: #2c3e50;
        }

        .candidate-country {
            color: #7f8c8d;
            font-size: 0.9rem;
            margin-bottom: 10px;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 6px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: #3498db;
            color: white;
        }

        .btn-primary:hover {
            background: #2980b9;
            transform: translateY(-2px);
        }

        .btn-success {
            background: #27ae60;
            color: white;
        }

        .btn-success:hover {
            background: #219653;
            transform: translateY(-2px);
        }

        .btn-danger {
            background: #e74c3c;
            color: white;
        }

        .btn-danger:hover {
            background: #c0392b;
            transform: translateY(-2px);
        }

        .btn:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
            transform: none;
        }

        .submit-section {
            text-align: center;
            margin: 30px 0;
            display: none;
        }

        .submit-section.active {
            display: block;
        }

        .admin-section {
            margin-top: 40px;
            border-top: 2px dashed #bdc3c7;
            padding-top: 30px;
        }

        .admin-title {
            text-align: center;
            font-size: 1.5rem;
            color: #2c3e50;
            margin-bottom: 20px;
        }

        .admin-buttons {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
        }

        .admin-btn {
            background: #9b59b6;
            color: white;
            padding: 12px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .admin-btn:hover {
            background: #8e44ad;
            transform: translateY(-2px);
        }

        .admin-btn.view {
            background: #3498db;
        }

        .admin-btn.reset {
            background: #f39c12;
        }

        .admin-btn.clear {
            background: #e74c3c;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .stat-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: #2c3e50;
            margin: 10px 0;
        }

        .stat-label {
            color: #7f8c8d;
            font-size: 0.9rem;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            overflow-y: auto;
        }

        .modal-content {
            background: white;
            margin: 50px auto;
            padding: 30px;
            border-radius: 15px;
            max-width: 800px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 2px solid #ecf0f1;
            padding-bottom: 15px;
        }

        .modal-title {
            font-size: 1.8rem;
            color: #2c3e50;
            font-weight: bold;
        }

        .close-btn {
            background: #e74c3c;
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            font-size: 1.2rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .close-btn:hover {
            background: #c0392b;
        }

        .vote-results {
            margin-top: 20px;
        }

        .vote-category {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
            border-left: 5px solid #3498db;
        }

        .vote-category-title {
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .vote-candidate {
            background: white;
            padding: 10px 15px;
            border-radius: 8px;
            margin: 5px 0;
            border: 1px solid #e9ecef;
        }

        .vote-candidate.winner {
            background: #e8f5e8;
            border-color: #27ae60;
            font-weight: bold;
        }

        .deadline-banner {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
            text-align: center;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 10px;
            font-weight: bold;
            font-size: 1.1em;
            box-shadow: 0 4px 15px rgba(231, 76, 60, 0.3);
        }

        .deadline-banner.ended {
            background: linear-gradient(135deg, #7f8c8d, #95a5a6);
        }

        .deadline-banner.warning {
            background: linear-gradient(135deg, #f39c12, #e67e22);
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 2rem;
            }
            
            .candidates-grid {
                grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            }
            
            .admin-buttons {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Deadline Banner -->
        <div class="deadline-banner" id="deadlineBanner">
            <i class="fas fa-clock"></i> Voting Ends: <span id="deadlineText"></span>
        </div>

        <header>
            <h1>ISU EXCELLENCE AWARD</h1>
            <h2>Category-Based Voting System</h2>
        </header>

        <div class="card">
            <div class="instructions">
                <p>Vote for ONE candidate in each category. Navigate through categories using Next/Previous buttons.</p>
                <p class="warning"><i class="fas fa-exclamation-triangle"></i> You can only vote once per device!</p>
            </div>

            <div class="progress-container">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width: 0%"></div>
                </div>
                <div class="progress-text" id="progressText">Category 1 of 34</div>
            </div>

            <div id="categoriesContainer">
                <!-- Categories will be loaded here one at a time -->
            </div>

            <div class="submit-section" id="submitSection">
                <button class="btn btn-success" onclick="submitVotes()">
                    <i class="fas fa-paper-plane"></i> Submit All Votes
                </button>
            </div>
        </div>

        <!-- Admin Section -->
        <div class="card admin-section">
            <div class="admin-title">
                <i class="fas fa-user-shield"></i> Admin Functions
            </div>
            <div class="admin-buttons">
                <button class="admin-btn view" onclick="viewAllVotes()">
                    <i class="fas fa-chart-bar"></i> View All Votes
                </button>
                <button class="admin-btn view" onclick="viewGoogleSheets()">
                    <i class="fas fa-table"></i> View Google Sheets
                </button>
                <button class="admin-btn reset" onclick="resetForNewVoter()">
                    <i class="fas fa-sync-alt"></i> New Voter
                </button>
                <button class="admin-btn clear" onclick="clearAllVotes()">
                    <i class="fas fa-trash-alt"></i> Clear All Votes
                </button>
                <button class="admin-btn" onclick="extendDeadline()">
                    <i class="fas fa-clock"></i> Extend Deadline
                </button>
                <button class="admin-btn view" onclick="viewVotingStats()">
                    <i class="fas fa-chart-pie"></i> Voting Stats
                </button>
            </div>

            <div class="stats-grid" id="statsContainer" style="display: none;">
                <!-- Stats will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Vote Results Modal -->
    <div class="modal" id="voteResultsModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title"><i class="fas fa-chart-bar"></i> All Vote Results</div>
                <button class="close-btn" onclick="closeModal()">×</button>
            </div>
            <div class="vote-results" id="voteResultsContent">
                <!-- Vote results will be loaded here -->
            </div>
        </div>
    </div>

    <script>
        // Voting deadline - 3 days from now
        const VOTING_DURATION_DAYS = 3;
        let VOTING_DEADLINE = new Date(Date.now() + VOTING_DURATION_DAYS * 24 * 60 * 60 * 1000).getTime();
        
        // Award categories
        const awardCategories = [
            "ISU Executive Board Member of the Year",
            "Most Dedicated Volunteer",
            "Outstanding Cultural Event of the Year",
            "International Students Athletes of the Year (Football, Volleyball, Basketball)",
            "Art & Creative Award",
            "Best Teacher of the Year",
            "Most Talented Award",
            "Most Popular Award (Male)",
            "Most Popular Award (Female)",
            "Most Active Award",
            "Best Behavior Award",
            "Best Cleaning Room Award",
            "Best Coach Award",
            "Best Student dancing Award",
            "Best Photographer award",
            "Student MC of the Year",
            "Best Course REP of the Year (Male)",
            "Best Course REP of the Year (Female)",
            "Best Artist of the Year",
            "Student Entrepreneur of the year",
            "Outstanding graphic designer of the year",
            "Gentlemen of the Year",
            "Lady of the Year",
            "Most fashionable Student (Male)",
            "Most fashionable Student (Female)",
            "Social Media Influencer of the year",
            "Most influential Student of the Year",
            "Best sports personality of the year",
            "Best Student in Politics of the year",
            "Best ISU appointees",
            "ISU Excellent Award",
            "Most influential personality of Football, Basketball, and volleyball",
            "Class Football Team of the year",
            "Committee/ Department Head of the year",
            "Best Initiative Award",
            "Academic Excellent Award (Undergraduate)",
            "Academic Excellent Award (Graduate)",
            "International Office Appreciation Award"
        ];

        // Candidate data
        const candidates = [
            { name: "EL-KHADIRI MERYEME", country: "Morocco", photo: "https://randomuser.me/api/portraits/women/44.jpg", positions: [0,8,17,20,30,35,37] },
            { name: "Michelle Okyerebea Asante", country: "GHANA", photo: "https://randomuser.me/api/portraits/women/33.jpg", positions: [1,8,9,10,11,19,22,25] },
            { name: "Kundayi Nigel Ndoro", country: "ZIMBABWE", photo: "https://randomuser.me/api/portraits/men/32.jpg", positions: [12,27,31] },
            { name: "BERRADA SOUHAIL", country: "MOROCCO", photo: "https://randomuser.me/api/portraits/men/22.jpg", positions: [15,21,23] },
            { name: "NIGINA", country: "UZBEKISTAN", photo: "https://randomuser.me/api/portraits/women/63.jpg", positions: [6,8,10,24,25] },
            { name: "Zulfiddin Mehriddinov", country: "UZBEKISTAN", photo: "https://randomuser.me/api/portraits/men/55.jpg", positions: [3,31] },
            { name: "MUHAMMADOV MUHAMMAD SODIK", country: "UZBEKISTAN", photo: "https://randomuser.me/api/portraits/men/66.jpg", positions: [27,31] },
            { name: "Diaby Khadjaly", country: "GUINEA", photo: "https://randomuser.me/api/portraits/men/77.jpg", positions: [14,20,21,30] },
            { name: "Wisdom Chisom", country: "Nigeria", photo: "https://randomuser.me/api/portraits/men/12.jpg", positions: [23] },
            { name: "Kra Kouassi Fedi", country: "Ivory Coast", photo: "https://randomuser.me/api/portraits/men/19.jpg", positions: [31] },
            { name: "Izzatullaev Musulmon", country: "UZBEKISTAN", photo: "https://randomuser.me/api/portraits/men/28.jpg", positions: [1,9,10] },
            { name: "Watson Karanda", country: "ZIMBABWE", photo: "https://randomuser.me/api/portraits/men/29.jpg", positions: [19] },
            { name: "Eze Victor", country: "Nigeria", photo: "https://randomuser.me/api/portraits/men/30.jpg", positions: [19,23] },
            { name: "Keita Fatumata S", country: "Liberia", photo: "https://randomuser.me/api/portraits/women/31.jpg", positions: [15] },
            { name: "Elma Taimu", country: "Zimbabwe", photo: "https://randomuser.me/api/portraits/women/32.jpg", positions: [13] },
            { name: "Marygold Vimbainashe", country: "ZIMBABWE", photo: "https://randomuser.me/api/portraits/women/33.jpg", positions: [3,31] },
            { name: "Khoshimov M", country: "UZBEKISTAN", photo: "https://randomuser.me/api/portraits/men/34.jpg", positions: [27,31] },
            { name: "Anika Jannatul Ferdush", country: "BANGLADESH", photo: "https://randomuser.me/api/portraits/women/35.jpg", positions: [1,2,8,9,11,13,22,26,30,34] },
            { name: "Serhani Anass", country: "MOROCCO", photo: "https://randomuser.me/api/portraits/men/36.jpg", positions: [3,27,31] },
            { name: "Andrew Stephen W", country: "CAMEROON", photo: "https://randomuser.me/api/portraits/men/37.jpg", positions: [3,27,31] },
            { name: "Matola Kenny Jerre", country: "South Africa", photo: "https://randomuser.me/api/portraits/men/38.jpg", positions: [3] },
            { name: "Karshygayeva Aiym", country: "KAZAKHSTAN", photo: "https://randomuser.me/api/portraits/women/39.jpg", positions: [6,8,26,36] },
            { name: "Chatir Soukaina", country: "MOROCCO", photo: "https://randomuser.me/api/portraits/women/40.jpg", positions: [11,22,27,35] },
            { name: "Duru Valentine Obinna", country: "Nigeria", photo: "https://randomuser.me/api/portraits/men/41.jpg", positions: [7] },
            { name: "Say Kong Tharak", country: "CAMBODIA", photo: "https://randomuser.me/api/portraits/men/42.jpg", positions: [2,11] },
            { name: "Ork Chanchutema", country: "CAMBODIA", photo: "https://randomuser.me/api/portraits/women/43.jpg", positions: [10,36] },
            { name: "Kong Mengsean", country: "CAMBODIA", photo: "https://randomuser.me/api/portraits/men/44.jpg", positions: [2,8,9,35,37] },
            { name: "Clarmancio Nilton Silva Fernandes", country: "Mozambique", photo: "https://randomuser.me/api/portraits/men/45.jpg", positions: [3,27] },
            { name: "Fixa", country: "MOROCCO", photo: "https://randomuser.me/api/portraits/men/46.jpg", positions: [25] },
            { name: "MAMAYUSUPOV ILKHOM", country: "Uzbekistan", photo: "https://randomuser.me/api/portraits/men/47.jpg", positions: [27,31] },
            { name: "Shaun Nkosinathi NG", country: "South Africa", photo: "https://randomuser.me/api/portraits/men/48.jpg", positions: [18] },
            { name: "AIT BAHMED FOUZIA", country: "MOROCCO", photo: "https://randomuser.me/api/portraits/women/49.jpg", positions: [5,6,10,12,22,27,35] },
            { name: "LUPAHLA SANELE", country: "Zimbabwe", photo: "https://randomuser.me/api/portraits/men/50.jpg", positions: [3,8,9,11,27] },
            { name: "OFFOR UCHECHI ROSELINE", country: "Nigeria", photo: "https://randomuser.me/api/portraits/women/51.jpg", positions: [11] },
            { name: "OUSSOUSS HAMID", country: "MOROCCO", photo: "https://randomuser.me/api/portraits/men/52.jpg", positions: [2,6,14] },
            { name: "SOT FA ELIN", country: "CAMBODIA", photo: "https://randomuser.me/api/portraits/women/53.jpg", positions: [0,4,9,11,14,20,25,28,30] },
            { name: "ORA", country: "Rwanda", photo: "https://randomuser.me/api/portraits/women/54.jpg", positions: [11] },
            { name: "PHIRI EMMANUEL", country: "Zambia", photo: "https://randomuser.me/api/portraits/men/55.jpg", positions: [1,10,33] },
            { name: "COMPUTER SCIENCE", country: "", photo: "https://randomuser.me/api/portraits/lego/1.jpg", positions: [32] },
            { name: "Mozumder Aktia Pableha", country: "BANGLADESH", photo: "https://randomuser.me/api/portraits/women/56.jpg", positions: [1] },
            { name: "Bekkaoui Souhaib", country: "Morocco", photo: "https://randomuser.me/api/portraits/men/57.jpg", positions: [4,13,23,28,34] },
            { name: "TOURE FRED RYAN", country: "Ivory Coast", photo: "https://randomuser.me/api/portraits/men/58.jpg", positions: [3,11,27,32] },
            { name: "KUNGNE KALEUK STEEVE JOSUE", country: "Cameroon", photo: "https://randomuser.me/api/portraits/men/59.jpg", positions: [1,35] },
            { name: "Naphtali Antonio", country: "", photo: "https://randomuser.me/api/portraits/men/60.jpg", positions: [14] },
            { name: "Magzhan", country: "Kazakhstan", photo: "https://randomuser.me/api/portraits/men/61.jpg", positions: [12,21] },
            { name: "Ahmed Qahtan", country: "Yemen", photo: "https://randomuser.me/api/portraits/men/62.jpg", positions: [21] },
            { name: "Takem Tchinda Saturnin", country: "Cameroon", photo: "https://randomuser.me/api/portraits/men/63.jpg", positions: [2,7,19] },
            { name: "KHALIL", country: "RUSSIA", photo: "https://randomuser.me/api/portraits/men/64.jpg", positions: [4,18] },
            { name: "Kadyrova Kadiya Demirovna", country: "Kyrgyzstan", photo: "https://randomuser.me/api/portraits/women/65.jpg", positions: [8,10,22,24] },
            { name: "CHAFAI ASMA", country: "MOROCCO", photo: "https://randomuser.me/api/portraits/women/66.jpg", positions: [1] },
            { name: "ANTWI ABRAHAM FORJOUR", country: "Ghana", photo: "https://randomuser.me/api/portraits/men/67.jpg", positions: [16] },
            { name: "Sherzat Shakirbaev", country: "Kyrgyzstan", photo: "https://randomuser.me/api/portraits/men/68.jpg", positions: [16,19,28] }
        ];

        let currentCategoryIndex = 0;
        let votes = {};
        let votingEnded = false;
        let hasVoted = localStorage.getItem('hasVoted') === 'true';

        // Initialize the voting system
        function init() {
            checkDeadline();
            loadCurrentCategory();
            
            // Load saved votes if any
            const savedVotes = localStorage.getItem('votes');
            if (savedVotes) {
                votes = JSON.parse(savedVotes);
                updateProgress();
            }
        }

        // Check voting deadline
        function checkDeadline() {
            const now = new Date().getTime();
            const timeLeft = VOTING_DEADLINE - now;

            if (timeLeft <= 0) {
                votingEnded = true;
                document.getElementById('deadlineBanner').classList.add('ended');
                document.getElementById('deadlineText').textContent = 'Voting Has Ended!';
                disableVoting();
            } else {
                // Update countdown display
                const days = Math.floor(timeLeft / (1000 * 60 * 60 * 24));
                const hours = Math.floor((timeLeft % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
                
                let countdownText = '';
                if (days > 0) {
                    countdownText = `${days} day${days > 1 ? 's' : ''}, ${hours} hour${hours > 1 ? 's' : ''} remaining`;
                    if (days === 1) {
                        document.getElementById('deadlineBanner').classList.add('warning');
                    }
                } else if (hours > 0) {
                    countdownText = `${hours} hour${hours > 1 ? 's' : ''}, ${minutes} minute${minutes > 1 ? 's' : ''} remaining`;
                    document.getElementById('deadlineBanner').classList.add('warning');
                } else {
                    countdownText = `${minutes} minute${minutes > 1 ? 's' : ''} remaining`;
                    document.getElementById('deadlineBanner').classList.add('warning');
                }
                
                document.getElementById('deadlineText').textContent = countdownText;
                
                // Update every minute
                setTimeout(checkDeadline, 60000);
            }
        }

        // Load current category
        function loadCurrentCategory() {
            if (hasVoted || votingEnded) {
                if (hasVoted) showAlreadyVoted();
                return;
            }

            const container = document.getElementById('categoriesContainer');
            const category = awardCategories[currentCategoryIndex];
            
            const categoryCandidates = candidates.filter(candidate => 
                candidate.positions.includes(currentCategoryIndex)
            );

            container.innerHTML = `
                <div class="category-title">${category}</div>
                <div class="category-description">
                    Select ONE winner from ${categoryCandidates.length} candidate(s)
                </div>
                
                <div class="candidates-grid">
                    ${categoryCandidates.map((candidate, index) => `
                        <div class="candidate-card" onclick="selectCandidate(${currentCategoryIndex}, '${candidate.name}')">
                            <img src="${candidate.photo}" alt="${candidate.name}" class="candidate-photo">
                            <div class="candidate-name">${candidate.name}</div>
                            <div class="candidate-country">${candidate.country}</div>
                        </div>
                    `).join('')}
                </div>
                
                <div class="navigation">
                    <button class="btn btn-primary" onclick="previousCategory()" ${currentCategoryIndex === 0 ? 'disabled' : ''}>
                        <i class="fas fa-arrow-left"></i> Previous
                    </button>
                    <button class="btn btn-primary" onclick="nextCategory()">
                        ${currentCategoryIndex === awardCategories.length - 1 ? 'Finish' : 'Next'} <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            `;

            updateProgress();
            
            if (votes[currentCategoryIndex]) {
                highlightSelectedCandidate(currentCategoryIndex, votes[currentCategoryIndex]);
            }
        }

        // Select candidate for category
        function selectCandidate(categoryIndex, candidateName) {
            if (votingEnded || hasVoted) {
                alert('Voting is not allowed at this time.');
                return;
            }
            votes[categoryIndex] = candidateName;
            highlightSelectedCandidate(categoryIndex, candidateName);
            updateProgress();
            saveVotes();
        }

        // Highlight selected candidate
        function highlightSelectedCandidate(categoryIndex, candidateName) {
            const cards = document.querySelectorAll('.candidate-card');
            cards.forEach(card => {
                card.classList.remove('selected');
                if (card.querySelector('.candidate-name').textContent === candidateName) {
                    card.classList.add('selected');
                }
            });
        }

        // Navigation functions
        function nextCategory() {
            if (currentCategoryIndex < awardCategories.length - 1) {
                currentCategoryIndex++;
                loadCurrentCategory();
            } else {
                showSubmitSection();
            }
        }

        function previousCategory() {
            if (currentCategoryIndex > 0) {
                currentCategoryIndex--;
                loadCurrentCategory();
            }
        }

        // Update progress
        function updateProgress() {
            const votedCount = Object.keys(votes).length;
            const progress = (votedCount / awardCategories.length) * 100;
            
            document.getElementById('progressFill').style.width = `${progress}%`;
            document.getElementById('progressText').textContent = 
                `Category ${currentCategoryIndex + 1} of ${awardCategories.length} • ${votedCount}/${awardCategories.length} voted`;
        }

        // Show submit section
        function showSubmitSection() {
            document.getElementById('submitSection').classList.add('active');
        }

        // Submit votes
        function submitVotes() {
            if (votingEnded || hasVoted) {
                alert('Voting is not allowed at this time.');
                return;
            }

            const totalVotes = Object.keys(votes).length;
            
            if (totalVotes === 0) {
                alert('Please vote in at least one category before submitting.');
                return;
            }

            // In a real implementation, this would send data to a server
            // For this demo, we'll just simulate submission
            alert(`✅ Success! ${totalVotes} votes submitted! Thank you for voting.`);
            
            // Mark as voted to prevent re-voting
            hasVoted = true;
            localStorage.setItem('hasVoted', 'true');
            showAlreadyVoted();
        }

        // Show already voted message
        function showAlreadyVoted() {
            document.getElementById('categoriesContainer').innerHTML = `
                <div style="text-align: center; padding: 40px;">
                    <i class="fas fa-check-circle" style="font-size: 4rem; color: #27ae60; margin-bottom: 20px;"></i>
                    <h2 style="color: #27ae60;">Thank You For Voting!</h2>
                    <p style="font-size: 1.2rem; margin-top: 10px;">You have already submitted your votes. Each person can only vote once.</p>
                    <p style="margin-top: 10px;">Results will be announced after the voting deadline.</p>
                </div>
            `;
            document.getElementById('submitSection').style.display = 'none';
        }

        // Save votes to localStorage
        function saveVotes() {
            localStorage.setItem('votes', JSON.stringify(votes));
        }

        // Disable voting when deadline passes
        function disableVoting() {
            const voteButtons = document.querySelectorAll('.candidate-card');
            voteButtons.forEach(button => {
                button.style.cursor = 'not-allowed';
                button.style.opacity = '0.6';
                button.onclick = null;
            });
            
            const navButtons = document.querySelectorAll('.btn');
            navButtons.forEach(button => {
                button.disabled = true;
                button.style.cursor = 'not-allowed';
            });
            
            document.querySelector('.instructions').innerHTML = 
                '<p style="color: #e74c3c;">⚠️ Voting has ended. Thank you for participating!</p>';
        }

        // Admin Functions
        function viewAllVotes() {
            const modal = document.getElementById('voteResultsModal');
            const content = document.getElementById('voteResultsContent');
            
            // In a real implementation, this would fetch from a server
            // For demo, we'll show the current user's votes
            let resultsHTML = '<h3>Your Votes</h3>';
            
            if (Object.keys(votes).length === 0) {
                resultsHTML += '<p>You haven\'t cast any votes yet.</p>';
            } else {
                for (const [categoryIndex, candidateName] of Object.entries(votes)) {
                    resultsHTML += `
                        <div class="vote-category">
                            <div class="vote-category-title">${awardCategories[categoryIndex]}</div>
                            <div class="vote-candidate winner">${candidateName}</div>
                        </div>
                    `;
                }
            }
            
            content.innerHTML = resultsHTML;
            modal.style.display = 'block';
        }

        function viewGoogleSheets() {
            alert('In a real implementation, this would open Google Sheets with the voting data.');
        }

        function resetForNewVoter() {
            if (votingEnded) {
                alert('Voting has ended. Cannot start new voting session.');
                return;
            }
            votes = {};
            currentCategoryIndex = 0;
            hasVoted = false;
            localStorage.removeItem('hasVoted');
            localStorage.removeItem('votes');
            document.getElementById('submitSection').classList.remove('active');
            loadCurrentCategory();
            updateProgress();
            alert('✅ Ready for new voter! Previous votes cleared.');
        }

        function clearAllVotes() {
            if (confirm('Are you sure you want to clear ALL votes? This action cannot be undone.')) {
                votes = {};
                localStorage.removeItem('votes');
                updateProgress();
                loadCurrentCategory();
                alert('All votes have been cleared.');
            }
        }

        function extendDeadline() {
            // Extend deadline by 1 day
            VOTING_DEADLINE += 24 * 60 * 60 * 1000;
            checkDeadline();
            alert('Voting deadline extended by 1 day.');
        }

        function viewVotingStats() {
            const statsContainer = document.getElementById('statsContainer');
            const totalVotes = Object.keys(votes).length;
            const completionRate = Math.round((totalVotes / awardCategories.length) * 100);
            
            statsContainer.innerHTML = `
                <div class="stat-card">
                    <div class="stat-label">Categories Voted</div>
                    <div class="stat-value">${totalVotes}</div>
                    <div class="stat-label">out of ${awardCategories.length}</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Completion Rate</div>
                    <div class="stat-value">${completionRate}%</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Current Category</div>
                    <div class="stat-value">${currentCategoryIndex + 1}</div>
                    <div class="stat-label">of ${awardCategories.length}</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Voting Status</div>
                    <div class="stat-value">${hasVoted ? 'Completed' : 'In Progress'}</div>
                </div>
            `;
            
            statsContainer.style.display = 'grid';
        }

        function closeModal() {
            document.getElementById('voteResultsModal').style.display = 'none';
        }

        // Initialize the voting system when page loads
        window.onload = init;
    </script>
</body>
</html>



